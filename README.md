# WebSocket Chat Application with Vite + React, Node.js, and MySQL

## Описание проекта

Это приложение — одностраничное веб-приложение (SPA) для чата в реальном времени, созданное с использованием **React** на фронтенде и **Node.js** с **Express** на бэкенде. Для передачи сообщений в реальном времени используется **WebSocket** через библиотеку **Socket.IO**. Данные сообщений и пользователей хранятся в базе данных **MySQL**.

## Основные функции:

- **Чат в реальном времени** с возможностью отправки текстовых сообщений, изображений и текстовых файлов.
- **Ответы на сообщения** с отображением вложенных комментариев.
- **Пагинация страниц** для удобной навигации по чату.
- **Фильтрация и сортировка сообщений** по имени пользователя, email и дате.
- **Капча для защиты от ботов**.
- **Валидация и санитизация данных** для обеспечения безопасности.

## Стек технологий:

- **Frontend**: React, CSS Modules, Socket.IO Client
- **Backend**: Node.js, Express, Socket.IO, Multer, Sharp, MySQL
- **База данных**: MySQL
- **WebSocket**: Socket.IO для передачи данных в реальном времени
- **Docker**: Контейнеризация для упрощённого развертывания

## Установка и настройка:

1. Клонирование репозитория:
Склонируйте репозиторий на локальную машину:
git clone https://github.com/ecoaurum/spa-app-websocket.git

2. Настройка backend:

- Создайте файл .env в директории server/ с параметрами для подключения к базе данных:
- 
	MYSQLHOST=<Ваш_хост>

	MYSQLUSER=<Ваш_пользователь>

	MYSQLPASSWORD=<Ваш_пароль>

	MYSQLDATABASE=<Имя_базы_данных>

	MYSQLPORT=<Порт_базы_данных> # по умолчанию 3306

	PORT=<Порт_сервера> # по умолчанию 5000

	CLIENT_URL=<URL_фронтенда>


- Перейдите в папку server и установите все зависимости:
- 
	cd server

	npm install
- Затем запустите сервер разработки ( Сервер будет запущен по адресу, который указан в настройках хостинга):
- 
	npm start

3. Настройка frontend:

- Создайте файл .env в директории client/ с параметрами для подключения фронтенда:
- 
	REACT_APP_SOCKET_URL=https://spa-app-websocket-server.up.railway.app
- Перейдите в папку client и установите все зависимости:
- 
	cd client

	npm install
- Запустите фронтенд приложение (Фронтенд будет доступен по адресу, который указан при деплое на хостинг.):
- 
	npm run dev

4. Запуск с Docker:
   
	- Проект также можно запустить с использованием Docker. Для этого выполните следующие шаги:

		1. Убедитесь, что у вас установлен Docker.
     
		2. Выполните команду для сборки и запуска контейнеров:
     
			- docker-compose up --build
     
	- Docker создаст контейнеры для фронтенда, бэкенда и базы данных MySQL. 

6. Использование

- Фронтенд:
	- Основные компоненты:
		- ChatPage: Основная страница чата с компонентами сообщений и отправки сообщений.
		- MessageBlock: Компонент для ввода и отправки сообщений, поддерживает отправку изображений, текстовых 		файлов и работу с CAPTCHA.
		- Body: Компонент для отображения списка сообщений с поддержкой ответов и вложенных комментариев.
 		- Pagination: Компонент для переключения между страницами сообщений.

	- Ключевые функции:
		- Отправка сообщений: Пользователи могут отправлять текстовые сообщения, загружать изображения и текстовые 		файлы. Поддерживается предпросмотр сообщения перед отправкой.
		- Ответы на сообщения: Поддерживается ответ на конкретные сообщения с отображением цитируемого текста.
		- Сортировка сообщений: Сообщения можно сортировать по имени пользователя, email и дате.
		-Модальные окна для изображений: Изображения, загруженные пользователями, можно просматривать в увеличенном 		виде.

- Бэкенд:
	- Основные маршруты:
		- /api/messages: Управление сообщениями (получение, создание, ответы).
		- /api/upload-image: Загрузка изображений на сервер.
		- /api/upload-file: Загрузка текстовых файлов на сервер.
		- /api/captcha: Генерация CAPTCHA для защиты от ботов.
	- Взаимодействие с WebSocket:
		- Событие newMessage: Событие для отправки нового сообщения в чат в реальном времени.
 		- Событие getMessages: Получение сообщений с пагинацией по страницам.
		- Событие messagesPage: Отправка сообщений на фронтенд с учётом текущей страницы.

### Описание ключевых моментов:

1. **Описание проекта**: В начале дается общее представление о проекте и его ключевых функциях.
2. **Стек технологий**: Указан список технологий, использованных для создания проекта.
3. **Установка и настройка**: Подробная инструкция по установке и запуску проекта как для локальной разработки, так и через Docker.
4. **Использование**: Раздел о ключевых компонентах и функциональности приложения, как фронтенда, так и бэкенда.
